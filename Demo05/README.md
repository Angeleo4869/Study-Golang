### Demo05
Go语言中支持函数、匿名函数和闭包
#### 一、函数定义
Go语言中定义函数使用关键字`func`：
```go
func 函数名(参数) (返回值) {
    函数体
}
```
- 函数名由字母，数字和下划线 `_` 组成，但不能以数字开头，在同一个包内，函数名不能相同
- 参数由参数变量和参数类型组成，多个参数之间用 `,`分割
```go
func f(x int, y int, str string){

}
```
- 返回值由返回值变量和变量类型组成，也可以只写返回值的类型，多个返回值必须用 `()`包裹，且用 `,` 分割
```go
func f()(x int, int, string){
    return 1, 2, "Hello"
}
```
- 函数体是实现功能的代码块
- 函数的参数与返回值是可选的，无返回值则返回值括号可以不写，无参数则参数括号必须写，返回值类型可以不命名
- 命名的返回值相当于在函数中声明一个变量，此时 `return` 后可以省略返回值
- 参数的类型简写，参数中连续相同类型的参数可以省略
```go
func f(x, y int){

}
```
- 可变长参数，其必须放在函数参数的最后
```go
func f(string , x ...int){
    //x的类型是切片
}
```

Go语言中的函数传递为值传递，及参数所传递的是其副本。

在一个命名的函数中不能声明另一个函数

#### 二、[Defer](DEFER/main.go)语句
Go语言中的 `defer` 语句会将其后面跟随的语句进行延迟处理。在 `defer` 归属的函数即将返回时，将延迟处理的语句按 `defer` 定义的逆序进行执行，即，先被 `defer` 的语句最后执行。
```go
func main() {
	fmt.Println("Start")
	defer fmt.Println("1")
	defer fmt.Println("2")
	defer fmt.Println("3")
	fmt.Println("End")
}
/*
Start
End
3  
2  
1
*/
```
Go语言中函数的 `return` 不是原子操作，在底层是分两步执行
1. 返回值赋值
2. 返回返回值
函数中如果存在 `defer` ,其执行的时机在第一步和第二部之间
```go
func f1() int {//返回值 = _ = x = 5,x++,x=6,_=5
    x := 5
    defer func() {
        x++ //修改的是x不是返回值
    }()
    return x
}

func f2()(x int){ //返回值为 x = 5，x++ ，x=6
    defer func(){
        x++
    }()
    return 5
}

func f3() (y int ) { //返回值为y = x = 5 ,x++，x=6，y=5
    x := 5
    defer func() {
        x++
    }()
    return x
}

func f4 () (x int) {  //返回值为x = 5
	defer func (x int)  {
		x++ //值传递，改变的是x的副本
	}(x)
	return 5
}
```

#### 三、[作用域](SCOPE/main.go)
作用域为已声明标识符所表示的常量、类型、变量、函数或包在源代码中的作用范围。
Go 语言中变量可以在三个地方声明：
- 函数内定义的变量称为局部变量
- 函数外定义的变量称为全局变量
- 函数定义中的变量称为形式参数
1. 局部变量
在函数体内声明的变量称之为局部变量，它们的作用域只在函数体内，参数和返回值变量也是局部变量.
```go
func main() {
   /* 声明局部变量 */
   var a, b, c int
   /* 初始化参数 */
   a = 10
   b = 20
   c = a + b
   fmt.Printf ("结果： a = %d, b = %d and c = %d\n", a, b, c)
}
```
2. 全局变量
在函数体外声明的变量称之为全局变量，全局变量可以在整个包甚至外部包（被导出后）使用。全局变量可以在任何函数中使用
```go
/* 声明全局变量 */
var g int

func main() {

   /* 声明局部变量 */
   var a, b int
}
```
3. 形式参数
形式参数会作为函数的局部变量来使用

4. 代码块内参数
在 `for` ，`if`， `switch` 或其他语句块内声明的变量，其作用域只能在代码块中

#### 四、[函数类型与变量](FUNC_TYPE/main.go)

函数的类型与其返回值类型一致

函数可以作为参数的类型

函数也可以作为返回值

#### 五、[匿名函数](FINC_Anonymous/main.go)
Go语言中，函数内部无法声明一个命名函数，此时可以通过匿名函数在函数内声明一个函数，
```go
func main() {
    var f = func (){
        //~~
    }
}
```
如果函数只使用一次，则可以写成立即使用函数
```go
func main() {
    func (){
        //~~
    }()
}
```

